# GAN-framework
## Introduction
This repository serves as an easy to use DCGAN framework. Simply download the image dataset you'd like to use and follow the steps below, and the program will be making its own unique images in no time! Note: the quality of the images produced will depend on the dataset fed to it and the hyperparameters used. I discuss some of my results with the program below.

This code is an edited version of pytorch's DCGAN tutorial, which can be found [here](https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html).
## What is a DCGAN?
A DCGAN is a GAN that utilizes convolutional neural networks in its architecture. The specifics of the networks used can be seen in ``agents.py`` and should be fairly readable for those familiar with neural nets.

For those unfamiliar, a GAN works by utilizing two neural nets in tandem. These are named the **generator** and the **discriminator**. The generator takes in a ``latent_dim``-dimensional vector and outputs an image. The discriminator takes in an image and outputs a single number that should equal ``real_label`` if the inputted image is from the dataset and ``fake_label`` if the image was generated by the generator. This allows the discriminator to improve at identifying which images are real and fake and allows the generator to improve at fooling the discriminator, thus producing more realistic images.
## Dependencies
You'll just need numpy, pytorch, and matplotlib.
## Dataset
The dataset used for this program should simply be a directory of images. The directory can also contain as many directories containing images as you please, however the GAN will not consider images in different directories any differently. Also, I am not sure if a directory in a directory in a directory will break the program, as I am not very familar with how pytorch's ``dataloader`` works. The images can be of any size initially (even different sizes), as the program uses pytorch to resize them all to the desired output image size.
## Hyperparameters
Hyperparameters change certain aspects of the networks, optimizers, and data. ``hyperparameters.py`` is a python file with a collection of variables used by ``training.py`` and ``agents.py``. The file has a large commented section explaining what each hyperparameter does. Most importantly, the first line is where you'll input the path to your dataset as a string. This should be the only file you need to touch if you want to create GAN pictures without any coding at all.
## Training
Run this once your hyperparameters have been set. It'll create a direcotry within the project directory called ``results`` and, for every ``sample_interval`` number of batches that the discriminator and generator train on, the program will:

1. Save a graph, saved as ``TotalLossPlot.png``, plotting the loss of each network at each batch and a line plotting the average loss of each network across a ``sample_interval`` number of batches (this file will be overwritten with an updated version every ``sample_interval``)
1. Save two files named ``discriminator.pt`` and ``generator.pt``, which can be used to load the trained model for further training or latent space exploration (these files will be overwritten with updated versions every ``sample_interval``)
1. Create a directory within the ``results`` directory named ``[batches_done]epoch[epoch]``, which serves to record the number of batches the nets have trained on and the number of epochs that have occured up to that point, respectively (the following list items are saved within this new directory)
1. Save 25 (or ``batch_size``, whichever is smaller) of the images generated by the generator and trained on by the discriminator in a single file named ``images.png``
1. Save a loss plot named ``lossPlot.png`` that plots the loss of each network at each batch done after the most recent ``sample_interval``
